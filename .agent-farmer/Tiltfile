docker_compose('../docker-compose.yml')

# Run the main Go application on the host
local_resource(
    'go-app',
    cmd='go run .',
    deps=['go.mod', 'app/', 'cmd/'],
    resource_deps=['postgres', 'redis'],
    port_forwards=[os.getenv('TASK_PORT', '8080') + ':8080']
)

# Run the Node.js web application on the host
local_resource(
    'web-app',
    cmd='npm run dev',
    deps=['web/package.json', 'web/src/'],
    resource_deps=['postgres'],
    port_forwards=[os.getenv('TASK_PORT', '3000') + ':3000']
)

print('Starting development environment for task: ' + os.getenv('TASK_NAME', 'unknown'))
print('Hostname: ' + os.getenv('TASK_HOSTNAME', 'localhost'))
print('Port: ' + os.getenv('TASK_PORT', '3000'))